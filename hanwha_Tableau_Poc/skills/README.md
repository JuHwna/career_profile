# 기본적으로 필요한 것들
(1) 달력 날짜와 계정 구분을 공통으로 사용해서 적용이 필요하다


(2) 달력 날짜의 경우, 매개변수를 통해 만든다.
- 날짜, 전체를 선택하여 매개변수 생성
- 만약에 기준이 되는 날짜 데이터가 문자열인 경우, 여러 방법이 있으나 안전하게 C_DATE로 만들어서 사용한다.
  -> DATE(DATEPARSE(‘yyyyMMdd’,[기준일자]))
- 이후에는 F_DATE를 만들어서 필터에 넣고 참만 선택한다.
->[C_DATE]=[P_DATE](매개변수 만든 거)


(3) 계정구분의 경우, 본사에서 설정한 기준을 통해 계산된 식을 만든 뒤에 필터에 넣어서 다중 선택가능하게 만든다.


<br/>
<br/>

## 도넛 차트 만들기
![통화 - 도넛 차트](https://user-images.githubusercontent.com/49123169/137048642-4e42e432-75f7-42a1-83b2-9616c88dce6b.png)

(1) 통화(포지션통화)로 존재., value 값을 구하면 된다.

(2) 각각의 value 값들을 구하기
- F_채권처럼 만들어 놓은 후에 집어 넣어도 되고 아니면 한 계산된 필드 안에 조건을 넣어놓고 만들어도 된다.
- 각 조건에 맞는 VALUE 값들을 만든 후에 합친다.

(3) 마크에서 파이차트를 클릭한 뒤에 합친 VALUE를 각도에 넣고 통화를 색상에 올려놓는다.

(4) 기존 파이차트를 만드는 것처럼 진행한다.

<br/>
<br/>

## 가로 막대 그래프 만들기

![신용 등급 - 가로 막대 그래프](https://user-images.githubusercontent.com/49123169/137048641-c6819f41-00fb-4078-8668-0f5e65ad7602.png)

(1) 국내와 해외를 구분해주는 차원 존재,, 신용등급 차원 존재, 넣을 값만 계산해서 넣으면 된다.

(2) 일단 국내와 해외가 숫자로 나와 있어 F_국내/해외 이런 식으로 계산된 필드를 만들어서 국내와 해외로 나타낸다.

(3) 신용등급의 경우, 저런 식으로 나눠져 있지 않아 그룹을 통해 AAA,AA,A,BBB이하로 나눈다. 그리고 무위험과 무등급의 경우, 만들면 국내와 해외로 나누어서 나타나기 때문에 따로 그려서 대시보드에서 합치는 방식을 사용한다.

(4) 값들을 넣어 막대그래프들을 만든다.

(5) 두 워크시트를 사용하여 만들었을 때 가장 큰 문제는 두 워크시트가 가지는 축의 범위가 달라 그래프 상에서 이상하게 보일 수도 있다. 따라서 MAX_SCALE값을 구해서 넣어 축의 범위를 맞추는 작업을 수행해야 한다.
- {FIXED : MAX({FIXED [C_국내/국외],[내부신용등급 TXT (그룹)] : SUM([C_1.1 VALUE])})


*추가 사항 : 위험회피관계번호 조건에 적합한 외환 파생을 뽑아서 사용해야 한다.
(종목코드가 4로 시작하고 위험회피관계번호가 비지 않는 것들)*
- 위험회피관계번호가 존재하면서 채권과 동일한 경우만 쓰면 되기 때문에 채권이면서 외환파생이면서 위험회피관계번호가 빈 것들을 필터로 걸고 사용한다.

<br/>
<br/>

![Sector - 가로 막대 그래프](https://user-images.githubusercontent.com/49123169/137048640-d555590c-f94a-4849-b6a0-f49f09ddb4ff.png)

(1) 국내해외 구분자 존재, 섹터 구분 값 존재, 값 존재, 넣기만 하면 된다.

(2) 해당 그래프는 각 조건으로 TOP 5를 뽑아야 하는데 기존의 필터 방식으로 진행하면 의도한 대로 결과값이 나오지 않을 수 있음
-> 따라서 RANK_UNIQUE를 써서 TOP5 그래프를 만들어주어야 한다.
->RANK_UNIQUE(SUM([C_채권_조]))
- 만든 후에 불연속형으로 전환하고 필터에 넣어 다섯 개를 선택한다. 그러면 원하는 TOP5 그래프를 만들 수 있음.


*추가 사항 : 국내와 국외 기준을 다시 나누고 위험회피관계번호 조건에 적합한 외환 파생을 뽑아서 사용해야 한다.*
- 국내와 국외의 경우 : 포지션통화를 기준으로 국내와 국외를 나눈다. ‘KRW’(국내), 그 이외(해외)
- 위험회피관계번호가 존재하면서 채권과 동일한 경우만 쓰면 되기 때문에 채권이면서 외환파생이면서 위험회피관계번호가 빈 것들을 필터로 걸고 사용한다.

<br/>
<br/>

![투자 형태 - 가로 막대 그래프](https://user-images.githubusercontent.com/49123169/137048643-f313f893-d5f9-42a8-9421-c0d243ea3641.png)

(1) 투자형태라는 구분자가 존재하지 않고 두 차원값을 통해 만들어야 한다.

(2) 투자형태별 조건들을 계산된 필드에 넣고 투자형태를 구분하는 차원과 그에 따른 값들을 두 가지로 나누어서 만든다.
- 이후에 추가로 해야하는 계산을 집어 넣으면 완성된다.


(3) 태블로에서는 막대 그래프 주변을 선으로 표시할 수 있는 기능은 있지만 점선 기능은 없기 때문에 테두리 정도 추가한 뒤에 막대 그래프 크기를 줄여서 다른 값임을 보여준다.

<br/>
<br/>

## 테이블 형태 만들기

![표](https://user-images.githubusercontent.com/49123169/137048644-b6a99af2-8915-42ea-b2ff-6a259c771691.png)

(1) 각 통화, 신용등급, 투자형태를 그리드를 통해 보여주어야 한다. 그래서 각 그리드의 열들을 위한 계산식을 만들어야 하고 매개변수 또한 필요하다.

(2) 매개변수 만들기 

①통화와 신용등급, 투자형태를 변경시킬 수 있는 매개변수와 계산식을 만든다. 매개변수의 경우, 
데이터 유형은 정수, 허용 가능한 값은 목록을 선택한다.
그리고 값에는 1,2,3을 넣고 표시 형식은 통화, 신용등급, 투자형태로 넣는다.

②계산된 필드를 하나를 만들어서 매개변수의 값에 맞는 것을 넣어 매개변수가 작동되게 만든다.
(IF [P_DIV]=1 THEN [포지션통화] ELSEIF [P_DIV]=2 THEN [C_내부신용등급_위험(그룹)]
ELSE [C_투자형태] END)

(3) 그리드의 값들을 구하는데 있어서 가중평균을 사용해야 한다면 분자는 INCLUDE를 써야 하고 분모는 EXCLUDE를 써야 한다.(그래야지 값이 바뀔 때 분자는 바뀌고 분모는 바뀌지 않는다.)

<br/>
<br/>

## 추가 사항들

+
불필요한 데이터를 제외 했는데 가끔씩 대시보드에 나타나는 경우가 발생
이러한 경우는 대시보드에서 클릭 시 다시 돌아갈 때 생기는 현상이므로 똑 같은 것을 복제한 뒤에 필터로 올려놔야지 문제가 없음
+
컨텍스트 필터를 적극적으로 활용해야 한다. 컨텍스트 필터가 Sub query 느낌으로 먼저 진행하기 때문에 대부분 올려놓은 필터를 컨텍스트 필터로 바꾸어야 한다. 
+
그리드마다 정렬이 다른 경우, 4가지 워크시트를 만들어서 사용해야 한다.
만들기 위해선 매개변수를 워크시트 제목으로 만들고 계산된 필드를 만든 매개변수만 올려놓는다. 그리고 각 워크시트마다 매개변수를 조정하고 필터에 아까 만든 계산된 필드를 올려놓고 해당되는 것에 체크를 한다면 대시보드에서 매개변수를 통해 바뀌는 워크시트를 만들 수 있다.
+
그리드나 막대그래프에서 매개변수를 통해 바뀌는데 한 가지만 정렬이 다르고 나머지는 같은 경우, 계산된 필드를 사용하여 정렬 방식을 바꿀 수 있다.
1) C_신용등급_SORT
- IF [신용등급]=’AAA’ THEN -1 ELSEIF [신용등급]=’AA+’ THEN -2
+
서식에서 사용자 지정을 통해 빈칸이나 – 표시, +-표시를 다 해줄 수 있다.
	값에 따른 + 표시 : +#,##0”억원”;-#,##0”억원”;
	값에 따른 – 표시 : -#,##0”억원”;+#,##0”억원”;
	0 값을 빈칸으로 표시 : #,##;-#; 

+
파이차트에서 가끔씩 원 안에 글자가 나와 그림이 예쁘지 않을 수 있음
그래서 이를 해결하기 위해선 해당 계산된 필드를 만들어서 텍스트를 넣고 컨텍스트 필터에 올려놓는다.
	IIF(AVG({FIXED : COUNTD([포지션통화]) })>1, [원하는 측정값], NULL)



